(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14545,        412]
NotebookOptionsPosition[     13974,        394]
NotebookOutlinePosition[     14369,        410]
CellTagsIndexPosition[     14326,        407]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{3.8810916664111147`*^9, 3.8810929178490543`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"beb0906e-e9f4-49d4-beca-7bbf437a0d6d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]x", " ", "=", " ", 
   RowBox[{"0.5", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Erf", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"a", "/", "2"}], " ", "-", " ", "x0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], "]"}], 
      " ", "-", " ", 
      RowBox[{"Erf", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"a", "/", "2"}], " ", "-", " ", "x0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]y", " ", "=", " ", 
   RowBox[{"0.5", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Erf", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "+", 
          RowBox[{"a", "/", "2"}], " ", "-", " ", "y0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], "]"}], 
      " ", "-", " ", 
      RowBox[{"Erf", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"a", "/", "2"}], " ", "-", " ", "y0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "*", "\[Sigma]"}], ")"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", 
   RowBox[{"\[Tau]", "*", "\[Lambda]x", "*", "\[Lambda]y"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "f", "}"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"jacobian", "[", 
    RowBox[{"x0", ",", "y0"}], "]"}], "[", "\[Mu]", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hessian", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "f", "}"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"hessian", "[", 
    RowBox[{"x0", ",", "y0"}], "]"}], "[", "\[Mu]", "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.881091628386222*^9, 3.881091630832222*^9}, 
   3.881091762950576*^9, {3.88109223219158*^9, 3.8810922466931353`*^9}, {
   3.881092279145091*^9, 3.8810922987741632`*^9}, {3.881092489689314*^9, 
   3.8810925434515333`*^9}, {3.881092604424156*^9, 3.881092608477673*^9}, 
   3.8810927041640387`*^9, {3.881092771029388*^9, 3.881092781541814*^9}, {
   3.8810929471077557`*^9, 3.881092953692152*^9}, {3.881093003998315*^9, 
   3.8810930261290293`*^9}, {3.8810930663445377`*^9, 3.881093067689962*^9}, {
   3.8810933451211567`*^9, 3.881093368623464*^9}, {3.881093426951474*^9, 
   3.881093430336491*^9}, {3.881093478359548*^9, 3.881093491341494*^9}, {
   3.881093635207712*^9, 3.881093671816049*^9}, 3.881094134281624*^9, {
   3.881094236433894*^9, 3.881094369335215*^9}, {3.88109446112812*^9, 
   3.881094480969071*^9}, {3.8810945578272038`*^9, 3.8810945694285393`*^9}, {
   3.881094743002877*^9, 3.88109474384689*^9}, {3.88109512535672*^9, 
   3.881095212451056*^9}, 3.881095244089403*^9, 3.881095299153944*^9, 
   3.881095336651846*^9, {3.881095499465554*^9, 3.881095516959497*^9}, {
   3.881095617670207*^9, 3.8810956737770348`*^9}, {3.881095731642407*^9, 
   3.881095749462039*^9}, {3.881095791339497*^9, 3.881095791501713*^9}, 
   3.8810960256387787`*^9, 3.8810966341894693`*^9, {3.881096719028344*^9, 
   3.881096770283946*^9}, {3.881098303321898*^9, 3.88109835452241*^9}, {
   3.881098385628594*^9, 3.881098388818964*^9}, 3.8817103491261787`*^9, {
   3.8817104978873587`*^9, 3.8817105800834208`*^9}, 3.881710675076016*^9, {
   3.881710713868661*^9, 3.881710744106658*^9}, {3.8817108139630203`*^9, 
   3.881710822658906*^9}, {3.881710947723806*^9, 
   3.881710965130275*^9}},ExpressionUUID->"9ac3bd4b-6bb6-46b0-9cad-\
275e5afa72ac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.25`", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["a", "2"]}], "+", "x", "-", "x0"}], ")"}]}], 
          SuperscriptBox["\[Sigma]", "3"]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["a", "2"], "+", "x", "-", "x0"}], ")"}]}], 
          SuperscriptBox["\[Sigma]", "3"]]}], ")"}], " ", "\[Tau]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Erf", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              FractionBox["a", "2"]}], "+", "y", "-", "y0"}], 
            RowBox[{
             SqrtBox["2"], " ", "\[Sigma]"}]], "]"}]}], "+", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{
            FractionBox["a", "2"], "+", "y", "-", "y0"}], 
           RowBox[{
            SqrtBox["2"], " ", "\[Sigma]"}]], "]"}]}], ")"}]}], 
      RowBox[{"0.25`", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"]}], ")"}], " ", 
       "\[Tau]"}]},
     {
      RowBox[{"0.25`", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "x", "-", "x0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]]}], "\[Sigma]"]}], ")"}], " ", 
       "\[Tau]"}], 
      RowBox[{"0.25`", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["a", "2"]}], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["a", "2"]}], "+", "y", "-", "y0"}], ")"}]}], 
          SuperscriptBox["\[Sigma]", "3"]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox["a", "2"], "+", "y", "-", "y0"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["a", "2"], "+", "y", "-", "y0"}], ")"}]}], 
          SuperscriptBox["\[Sigma]", "3"]]}], ")"}], " ", "\[Tau]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Erf", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              FractionBox["a", "2"]}], "+", "x", "-", "x0"}], 
            RowBox[{
             SqrtBox["2"], " ", "\[Sigma]"}]], "]"}]}], "+", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{
            FractionBox["a", "2"], "+", "x", "-", "x0"}], 
           RowBox[{
            SqrtBox["2"], " ", "\[Sigma]"}]], "]"}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.881710827950307*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"c5f4468a-a4f8-4b2a-9521-\
227ebcb1f6e2"]
}, Open  ]]
},
WindowSize->{1440., 721.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1c8be80d-fe92-42c2-b6f1-7d803dffc420"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 173, 2, 29, "Input",ExpressionUUID->"beb0906e-e9f4-49d4-beca-7bbf437a0d6d"],
Cell[CellGroupData[{
Cell[756, 26, 4525, 114, 174, "Input",ExpressionUUID->"9ac3bd4b-6bb6-46b0-9cad-275e5afa72ac"],
Cell[5284, 142, 8674, 249, 191, "Output",ExpressionUUID->"c5f4468a-a4f8-4b2a-9521-227ebcb1f6e2"]
}, Open  ]]
}
]
*)

